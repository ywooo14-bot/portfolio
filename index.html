<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UI设计作品集</title>
    
    <!-- Favicon设置 -->
    <link rel="apple-touch-icon" sizes="180x180" href="./favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon_io/favicon-16x16.png">
    <link rel="icon" type="image/x-icon" href="./favicon_io/favicon.ico">
    <link rel="manifest" href="./favicon_io/site.webmanifest">
    
    <!-- 强制浏览器不缓存favicon -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
   <style>
            imgElement.onload = function() {
                // 确保图片完全加载后再显示
            };
        }
        
        // 更新加载指示器
        function updateLoadingIndicator(show) {
            if (show === false) {
                elements.loadingIndicator.style.display = 'none';
                return;
            }
            
            if (state.totalImagesToLoad > 0) {
                const processed = state.loadedImages + state.failedImages;
                const percentage = Math.round((processed / state.totalImagesToLoad) * 100);
                elements.loadingIndicator.textContent = `加载中... ${percentage}%`;
                elements.loadingIndicator.style.display = 'block';
            }
        }
        
        // 显示错误提示
        function showError(message) {
            if (state.hasShownError) return;
            
            state.hasShownError = true;
            const errorMessage = elements.errorContainer.querySelector('.error-message');
            errorMessage.textContent = message || '网络异常，请重新加载';
            elements.errorContainer.style.display = 'flex';
            updateLoadingIndicator(false);
        }
        
        // 隐藏错误提示
        function hideError() {
            state.hasShownError = false;
            elements.errorContainer.style.display = 'none';
        }
        
        // 网络状态处理
        function handleOnline() {
            state.isOnline = true;
            if (state.hasShownError) {
                hideError();
                // 重试失败的图片
                for (let i = 1; i <= CONFIG.MAX_IMAGES; i++) {
                    if (state.imageStatus[i] && !state.imageStatus[i].loaded) {
                        loadImage(i);
                    }
                }
            }
        }
        
        function handleOffline() {
            state.isOnline = false;
            if (state.loadedImages === 0 && !state.hasShownError) {
                showError('网络连接已断开');
            }
        }
        
        // 初始化
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
